# 게임 개발 계획서: 던전 앤 디스코드 (v3.0 - Tarkov-lite)

**문서 목적**: 이 문서는 `던전 앤 디스코드` 게임 개발의 전체적인 로드맵과 우선순위를 정의합니다. 모든 개발 작업은 이 계획을 기반으로 진행하며, 상세한 게임 디자인 명세는 `docs/game_design_detail.md`를 따릅니다.

---

### 1. 핵심 비전 및 목표

- **비전**: 디스코드에서 즐기는, 리스크와 리턴의 저울질이 핵심인 **장비 기반 로그라이트(Equipment-based Rogue-lite)**.
- **핵심 목표**: 플레이어가 자신의 '기지'에서 직접 장비를 세팅하여 탐험에 나서고, 죽음의 리스크를 감수하며 더 좋은 전리품을 획득하여 돌아오는 중독적인 플레이 루프를 완성한다. 모든 탐험은 그 자체로 한 편의 이야기가 된다.

---

### 2. 주요 기능 및 시스템 (Features & Systems)

*   **기지 (The Base)**: 플레이어의 모든 자산(아이템, 룬)을 보관하는 개인 공간. 탐험을 준비하고, 전리품을 저장하고, 영구적인 성장을 도모하는 허브 역할을 합니다.
*   **아이템 기반 성장 (Item-driven Progression)**: 캐릭터의 레벨/경험치 시스템을 완전히 배제. 캐릭터의 강함은 오직 **(1) 기지에서 가져온 장비**와 **(2) 탐험 중 획득한 장비**로만 결정됩니다.
*   **리스크 있는 탐험 (High-stakes Exploration)**: 탐험 중 사망 시, **가져갔던 장비와 획득했던 전리품을 모두 잃습니다.** 이 '장비 소실(Gear Fear)'의 긴장감은 모든 판단을 의미있게 만듭니다.
*   **절차적 던전 생성 (Procedural Dungeon Generation)**: 매번 새로운 구조의 던전을 제공하여, 암기가 아닌 임기응변 능력을 시험합니다.
*   **전술적 턴제 상호작용 (Tactical Turn-based Interaction)**: 8방향 이동, 시야(FoV) 시스템, 지형지물과의 상호작용을 통해 신중한 판단을 요구하는 턴제 게임플레이를 제공합니다.
*   **탈출 메커니즘 (Extraction Mechanics)**: 던전 깊은 곳에 있는 '탈출 포탈'이나 희귀 소모품 '귀환 스크롤'을 통해서만 안전하게 귀환하고 전리품을 '소유'할 수 있습니다.

---

### 3. 개발 로드맵 (Development Roadmap)

개발은 총 5개의 단계(Phase)로 나누어 진행합니다.

#### **Phase 0: 기반 구축 및 핵심 렌더링 (Foundation & Core Rendering)**
*   **목표**: 게임의 가장 기본적인 시각적 요소와 상호작용의 뼈대를 완성합니다. 플레이어가 맵을 보고 움직이는 경험을 구현하는 데 집중합니다.
*   **주요 과업**:
    1.  **코어 게임 루프 설계**: 게임 상태(Game State)를 관리하고, 플레이어의 입력을 받아 턴을 진행하는 기본 구조를 설계합니다.
    2.  **뷰포트 렌더러 구현**: `(완료)` 플레이어 중심의 맵을 코드 블록과 이모지로 렌더링합니다.
    3.  **시야(FoV) 시스템 구현**: `(완료)` `시야 내`, `기억 속`, `미탐험` 영역을 시각적으로 구분합니다.
    4.  **기본 이동 및 상호작용 구현**: `(완료)` 8방향 이동 및 '입력 잠금' 메커니즘을 구현합니다.

#### **Phase 1: 기지와 탐험의 순환 (Base & Exploration Cycle)**
*   **목표**: 플레이어가 기지에서 탐험을 준비하고, 던전에 입장했다가, 탈출하여 아이템을 저장하는 핵심 게임 루프를 완성합니다.
*   **주요 과업**:
    1.  **DB 스키마 재설계**:
        - `player_characters`는 영구적인 캐릭터 정보를 저장합니다 (레벨/경험치 제외).
        - `stash_items` (창고), `character_inventory` (탐험 시 인벤토리) 등 아이템 소유권을 명확히 구분하는 테이블 구조를 설계합니다.
    2.  **`/기지` 명령어 기초 구현**:
        - 플레이어의 창고(`stash_items`) 아이템을 보여주는 UI를 구현합니다.
        - 창고와 캐릭터 인벤토리 간에 아이템을 옮기는 기능을 구현합니다.
    3.  **탐험 시작 및 종료 로직 구현**:
        - `/탐험시작`: 준비된 인벤토리 그대로 던전에 입장하는 기능을 구현합니다.
        - `탈출`: 탐험 성공 시, 캐릭터 인벤토리의 모든 아이템을 창고로 이전하는 로직을 구현합니다.
        - `사망`: 탐험 실패 시, 캐릭터 인벤토리의 모든 아이템을 삭제하는 로직을 구현합니다.
    4.  **절차적 던전 생성기 개선**: '일방통행' 구조에 맞춰, '아래로 가는 계단' 또는 '탈출 포탈'을 생성하는 로직을 구현합니다.

#### **Phase 2: 아이템과 전투 (Items & Combat)**
*   **목표**: 던전 탐험의 핵심인 전투와 아이템 파밍의 재미를 구현합니다.
*   **주요 과업**:
    1.  **기본 전투 시스템 구현**: 플레이어와 몬스터가 턴을 주고받으며 싸우는 기초적인 전투 로직을 구현합니다. (공격, 피해 계산, HP 반영)
    2.  **몬스터 배치 및 AI 구현**: 던전 생성 시 몬스터를 배치하고, 플레이어를 향해 다가오는 간단한 AI를 구현합니다.
    3.  **아이템 드랍 시스템 구현**: 몬스터 사망 시, 정의된 드랍 테이블에 따라 아이템(장비, 소모품, 룬)을 생성하고 바닥에 떨어뜨리는 기능을 구현합니다.
    4.  **아이템 줍기/교체 기능**: 바닥의 아이템을 줍고, 자신의 장비와 교체하는 UI 및 로직을 구현합니다.

#### **Phase 3: 기지의 심화와 '룬'의 역할 (Deepening the Base & The Role of 'Rune')**
*   **목표**: 장기적인 성장의 동기를 부여하는 '룬' 시스템과 기지의 확장 기능을 구현합니다.
*   **주요 과업**:
    1.  **'룬' 시스템 구현**:
        - 몬스터가 룬을 드랍하고, 탈출 시에만 획득이 확정되는 시스템을 구현합니다.
        - DB에 플레이어별 룬 보유량을 저장하고 관리합니다.
    2.  **기지 업그레이드 기능 구현**: `/기지` 명령어에 '룬'을 사용하여 업그레이드하는 상점 UI를 추가합니다.
        - **창고 확장**: 룬을 지불하여 창고의 최대 크기를 늘립니다.
        - **제작대/연구소 해금**: 추후 콘텐츠 확장을 위한 제작/연구 기능을 룬으로 해금하는 기능을 구현합니다.
    3.  **보급고 기능 구현**: `/기지`에서 룬을 사용해 다음 탐험에 사용할 1회용 소모품을 구매하는 기능을 구현합니다.

#### **Phase 4: 다듬기 및 콘텐츠 확장 (Polishing & Content Expansion)**
*   **목표**: 완성된 시스템을 기반으로 게임의 완성도를 높이고, 장기적으로 즐길 수 있는 콘텐츠를 추가합니다.
*   **주요 과업**:
    1.  **신규 콘텐츠 추가**: 새로운 종족, 직업, 다양한 등급의 아이템, 특수 능력을 가진 몬스터, 보스 등을 추가합니다.
    2.  **제작 및 강화 시스템 구현**: '제작대'에서 재료를 조합해 아이템을 만들거나, 기존 장비를 강화하는 시스템을 구현합니다.
    3.  **밸런스 조정**: 아이템 드랍률, 몬스터 능력치, 룬 획득량 등 게임의 경제와 난이도 곡선을 지속적으로 테스트하고 조정합니다.
    4.  **UI/UX 개선**: 사용자 피드백을 바탕으로 명령어 설명, 버튼 배치, 정보 가시성 등 편의성을 개선합니다.

---

### 4. 데이터 및 버전 관리 (Data & Version Management)

*   **원칙**: 코드 버전(Git)과 데이터 버전(DB)을 통합 관리하여, 배포 시 항상 코드와 데이터베이스의 정합성을 보장합니다.
*   **프로세스**: 봇 시작 시, 코드에 정의된 최신 데이터 버전과 DB에 기록된 버전을 비교하여, 차이가 있을 경우 `sql/updates/` 폴더의 스크립트를 순차적으로 자동 실행합니다.

---

### 5. 참고 자료 (References)

*   **주요 레퍼런스**: Escape from Tarkov, Dark and Darker, Zero Sievert
*   **상세 게임 디자인**: `docs/game_design_detail.md`
*   **데이터베이스 스키마**: `sql/create_game_tables.sql` 